import time
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
#%matplotlib inline
#%matplotlib notebook

'''–ó–∞–¥–∞–Ω–∏–µ 1
–ü–æ—Å—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:
$y=\cos(x) + 0.05x^3 + \log_2{x^2}$ 
–≤ —Ç–æ—á–∫–µ x = 10.

–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–∏ y:
$\dot{y}=-\sin(x) + 0.15x^2 +\frac{2x}{{x^2ln2}}$ 
'''
'–§—É–Ω–∫—Ü–∏—è —É –∑–∞–¥–∞–∏—é 1'
def F(x):
    y = np.cos(x) + 0.005*x**3 + np.log2(2)
    return y
'–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —É –∑–∞–¥–∞–∏—é 1'
def DF(x):
    y = -1*np.sin(x) + 0.15*x**2 + (2*x)/(x**2*np.log(2))
    return y

''' –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –∑–∞–¥–∞–Ω–∏—é 2'''
#—Ñ—É–Ω–∫—Ü–∏—è —á–∞—Å—Ç–Ω–æ–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –ø–æ x1
def dif_x1(x1, x2):
    pr_dif_x1 = 2*x1*np.cos(x2)+9*x1**2*np.log2(x2**2)
    return pr_dif_x1
#—Ñ—É–Ω–∫—Ü–∏—è —á–∞—Å—Ç–Ω–æ–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –ø–æ x2
def dif_x2(x1, x2):
    pr_dif_x2 = -1*x1**2*np.sin(x2)+0.15*x2**2+(6*x1**3*x2)/(x2**2*np.log(2))
    return pr_dif_x2

''' –ó–∞–Ω–∞–∏–µ 3 –ù–∞–π—Ç–∏ —Ç–æ—á–∫—É –º–∏–Ω–∏–º—É–º—É –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏  ùëå=cos(ùë•)+0.05ùë•3+log2ùë•2 .'''

def F3(x):
    #–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    func_y = np.cos(x) + 0.05*(x**3)+ np.log2(x**2)
    return func_y
def DF3(x):
    #–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –π—É–Ω–∫—Ü–∏–∏ F3
    dif_y= -1*np.sin(x)+0.15*(x**2)+(2*x)/(x**2*np.log(2))
    return dif_y

''' –ó–∞–¥–∞–Ω–∏–µ 4 
–Ω–∞–π—Ç–∏ —Ç–æ—á–∫—É –º–∏–Ω–∏–º—É–º—É –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏  ùë•21cos(ùë•2)+0.05ùë•32+3ùë•31log2ùë•22 . 
–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä  ùúñ=0.001 , –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ—Å–æ–≤ –ø—Ä–∏–Ω—è—Ç—å —Ä–∞–≤–Ω—ã–º [4, 10].
'''
def F4(x1, x2):
    f4= x1**2*np.cos(x2)+0.005*x2**3+3*x1**3*np.log2(x2**2)
    return f4

#—Ñ—É–Ω–∫—Ü–∏—è —á–∞—Å—Ç–Ω–æ–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –ø–æ x1
def Dif4_x1(x1, x2):
    pr_dif4_x1 = 2*x1*np.cos(x2)+9*x1**2*np.log2(x2**2)
    return pr_dif4_x1
#—Ñ—É–Ω–∫—Ü–∏—è —á–∞—Å—Ç–Ω–æ–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –ø–æ x2
def Dif4_x2(x1, x2):
    pr_dif4_x2 = -1*x1**2*np.sin(x2)+0.15*x2**2+(6*x1**3*x2)/(x2**2*np.log(2))
    return pr_dif4_x2

x = 10
print("–ó–∞–¥–∞–Ω–∏–µ 1")
print('–ó–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ F(x) –≤ —Ç–æ—á–∫–µ 10:', F(x))
print('–ó–Ω–∞—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–µ–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ DF(x) –≤ —Ç–æ—á–∫–µ 10:', DF(x))

# x_ar = np.linspace(0.01, 30, 1000)
# y_ar = list(map(F, x_ar))
#
# x_ar = np.linspace(0.01, 30, 1000)
# y_ar = list(map(F, x_ar))
#
# plt.figure(figsize=(5,5))
# plt.plot(x_ar, y_ar,'--', color='red')
# plt.ylabel("Y")
# plt.xlabel("X")
# plt.scatter([x], [F(x)], lw=3)
# plt.show()

'''–ó–∞–¥–∞–Ω–∏–µ 2
–ü–æ—Å—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏ $x_1^2\cos(x_2) + 0.05x_2^3 + 3x_1^3\log_2{x_2^2}$ –≤ —Ç–æ—á–∫–µ $(10, 1)$'''



in_x1= 10
in_x2 = 1
print('–ó–∞–¥–∞–Ω–∏–µ 2 –ü–æ—Å—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏  10, 1')
print('–ó–Ω–∞—á–µ–Ω–∏–µ —á–∞—Å—Ç–Ω–∞—è  –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è Z –ø–æ x1: ', dif_x1(in_x1, in_x2))
print('–ó–Ω–∞—á–µ–Ω–∏–µ —á–∞—Å—Ç–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è Z –ø–æ x2: ', dif_x2(in_x1, in_x2))


'–ó–∞–¥–∞–Ω–∏–µ 3'

n = 2000 # —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π
xn = 10 #–ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
eps = 0.001 #—à–∞–≥ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ 0.1, 0.2, 0.9, 1

#–†–∏—Å—É–µ–º –≥—Ä–∞—Ñ–∏–∫ —Ñ—É–Ω–∫—Ü–∏–∏
x_plt = np.arange(-10, 10.0, 0.1)
f_plt = [F3(x) for x in x_plt]

plt.ion() # –≤–∫–ª—é—á–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
fig, ax = plt.subplots() # –°–æ–∑–¥–∞–µ–º –æ–∫–Ω–∞ –∏ –æ—Å–µ–π –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
ax.grid(True) #–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ—Ç–∫–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
ax.plot(x_plt, f_plt, '--', color='green') # –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ —Ñ—É–Ω—É–∫–∏—Ü–∏–∏ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ x_plt
point = ax.scatter(xn, F3(xn), c ='red') #–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º

# –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º
mn = 300  # –æ–≥—Ä–∞–Ω–∏—á–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è –Ω–æ—Ä–º–∏—Ä—É—é—â–µ–≥–æ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞)

for i in range(n):
    eps = 1 / min(i + 1, mn)  # –ø—Ä–æ–≤–µ–¥–µ–º –Ω–æ—Ä–º–∏–∞—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
    # xn= xn - eps*DF3(xn) #–∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
    xn = xn - eps * np.sign(DF3(xn))  # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
    point.set_offsets([xn, F3(xn)])  # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç–æ—á–∫–∏

    # –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞ –∏ –∑–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ 20–Ω—Å
    fig.canvas.draw()
    fig.canvas.flush_events()
    time.sleep(0.001)

plt.ioff() # –í—ã–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
print('–ó–∞–¥–∞–Ω–∏–µ 3.')
print('–§—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç–∏–≥–∞–µ–º –º–∏–Ω–∏–º—É–º –≤ —Ç–æ—á–∫–µ x:',xn)
ax.scatter(xn, F3(xn), c='blue')
plt.show()
print('i=', i)

#–ó–∞–¥–∞–Ω–∏–µ 4

n = 2000  # —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –ø–æ a

in_a = 4  # –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
in_b = 10  # –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
in_a—Å = 4  # –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞
in_bc = 10  # –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞
eps = 0.001  # —à–∞–≥ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏

print('–ó–∞–¥–∞–Ω–∏–µ 4')
print('–ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ Z')
print('Z=', F4(in_a, in_b))
print('Za=', Dif4_x1(in_a, in_bc))
print('Zb=', Dif4_x2(in_a—Å, in_b))

# –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º
mn = 300  # –æ–≥—Ä–∞–Ω–∏—á–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è –Ω–æ—Ä–º–∏—Ä—É—é—â–µ–≥–æ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞

for i in range(n):
    eps = 1 / min(i + 1, mn)  # –ø—Ä–æ–≤–µ–¥–µ–º –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
    in_a = in_a - eps * np.sign(Dif4_x1(in_a, in_bc))  # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
    z_a = Dif4_x1(in_a, in_bc)
    in_b = in_b - eps * np.sign(Dif4_x2(in_a—Å, in_b))  # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
    z_b = Dif4_x2(in_a—Å, in_b)

print('–ù–∞–π–¥–µ–Ω—ã–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ Z')
print('Z=', F4(in_a, in_b), 'in_a=:', in_a, 'in_b=', in_b)
print('z_a=', z_a, 'z_b=', z_b)